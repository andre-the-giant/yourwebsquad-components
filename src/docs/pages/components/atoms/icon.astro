---
import DocLayout from "../../../layouts/DocLayout.astro";
import Preview from "../../../components/Preview.astro";
import PropsTable from "../../../components/PropsTable.astro";
import { components } from "../../../data/components.js";
import IconComponent from "@lib/components/Icon/Icon.astro";

const iconNames = ["spark", "arrow-right", "grid"];
const defaultCode = `<Icon content={{ name: "spark" }} />`;
const sizesCode = `<Icon content={{ name: "spark" }} size="sm" />\n<Icon content={{ name: "spark" }} size="md" />\n<Icon content={{ name: "spark" }} size="lg" />`;
const registryNames = ["hamburger", "external", "arrow-right", "spark"];
const registryCode = `// Use a predefined registry name\n<Icon content={{ name: \"hamburger\" }} />\n<Icon content={{ name: \"external\" }} />`;

const runtimeSvg = `<path d=\"M3 6h18\" /><path d=\"M3 12h18\" /><path d=\"M3 18h18\" />`;
const runtimeCode = `// Pass raw SVG inner markup at runtime\n<Icon content={{ svgPath: '${runtimeSvg}', viewBox: '0 0 24 24' }} size=\"md\" label=\"Runtime hamburger\" />`;
const alertIcons = ["info", "success", "warning", "error"];
const alertIconsCode = alertIcons
  .map((name) => `<Icon content={{ name: "${name}" }} />`)
  .join("\\n");

const props = [
  {
    name: "content",
    type: "{ name?, label?, svgPath?, svg?, viewBox?, strokeWidth?, strokeLinecap?, strokeLinejoin? }",
    description: "Defaults/inline SVG details; overridden by direct props."
  },
  { name: "name", type: "string", default: '"spark"', description: "Registry icon name." },
  {
    name: "label",
    type: "string",
    description: "Accessible label; omitting hides icon from a11y tree."
  },
  {
    name: "size",
    type: `"sm" | "md" | "lg"`,
    default: '"md"',
    description: "Pre-set pixel sizes (16/24/32)."
  },
  { name: "class", type: "string", description: "Additional className." },
  { name: "color", type: "string", description: "Override currentColor." }
];
---

<DocLayout
  title="Icon"
  description="Inline SVG icons with consistent sizing and color."
  items={components}
>
  <PropsTable props={props} />

  <Preview title="Default" code={defaultCode}>
    <div class="row">
      {iconNames.map((name) => <IconComponent content={{ name }} />)}
    </div>
  </Preview>

  <Preview title="Registry icons" code={registryCode}>
    <div class="row">
      {registryNames.map((name) => <IconComponent content={{ name }} />)}
    </div>
  </Preview>

  <Preview title="Alert icons" code={alertIconsCode}>
    <div class="row">
      {alertIcons.map((name) => (
        <IconComponent content={{ name }} label={`${name} icon`} />
      ))}
    </div>
  </Preview>

  <Preview title="Runtime SVG" code={runtimeCode}>
    <div class="row">
      <IconComponent
        content={{ svgPath: runtimeSvg, viewBox: "0 0 24 24" }}
        label="Runtime hamburger"
      />
      <IconComponent
        content={{
          svgPath: '<path d="M5 12h14" /><path d="M13 6l6 6-6 6" />',
          viewBox: "0 0 24 24"
        }}
        label="Runtime arrow"
      />
    </div>
  </Preview>

  <section class="notes">
    <h3>Usage notes</h3>
    <p>The `Icon` component supports two modes:</p>
    <ul>
      <li>
        <strong>Registry:</strong> pass `content={{ name: "icon-name" }}` to use a predefined icon
        from the registry.
      </li>
      <li>
        <strong>Runtime SVG:</strong> pass `content={
          { svgPath: "<path .../>", viewBox: "0 0 24 24" }
        }` to render ad-hoc SVG markup without rebuilding the library.
      </li>
    </ul>
    <p>
      For safety and consistency the component sanitizes the inner SVG markup by removing any inline
      `fill`, `stroke` and `style` attributes. The outer &lt;svg> uses `fill="currentColor"` and
      `stroke="currentColor"`, so icons inherit color from CSS. To override the color, pass the
      `color` prop or set the parent `color` CSS.
    </p>
    <p>
      Accessibility: provide a `label` (or `ariaLabel` in `content`) to expose an accessible name.
      If no label is supplied the icon is considered decorative and will be `aria-hidden`.
    </p>
    <pre><code>// registry
&lt;Icon content={{ name: "external" }} label="Open external link" /&gt;

// runtime
&lt;Icon content={{ svgPath: '<path d="M3 6h18" />', viewBox: '0 0 24 24' }} label="Menu" /&gt;</code></pre>
  </section>

  <Preview title="Sizes" code={sizesCode}>
    <div class="row">
      <IconComponent content={{ name: "spark" }} size="sm" />
      <IconComponent content={{ name: "spark" }} size="md" />
      <IconComponent content={{ name: "spark" }} size="lg" />
    </div>
  </Preview>
</DocLayout>

<style>
  .row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    align-items: center;
  }
</style>
