---
import DocLayout from "../../../layouts/DocLayout.astro";
import Preview from "../../../components/Preview.astro";
import PropsTable from "../../../components/PropsTable.astro";
import { components } from "../../../data/components.js";
import IconComponent from "@lib/components/Icon/Icon.astro";

const iconNames = ["spark", "arrow-right", "grid"];
const defaultCode = `<Icon name="spark" />`;
const sizesCode = `<Icon name="spark" size="sm" />\n<Icon name="spark" size="md" />\n<Icon name="spark" size="lg" />`;
const registryNames = ["hamburger", "external", "arrow-right", "spark"];
const registryCode = `// Use a predefined registry name\n<Icon name="hamburger" />\n<Icon name="external" />`;

const runtimeSvg = `<path d=\"M3 6h18\" /><path d=\"M3 12h18\" /><path d=\"M3 18h18\" />`;
const runtimeCode = `// Pass raw SVG inner markup at runtime\n<Icon svgPath='${runtimeSvg}' viewBox='0 0 24 24' size="md" label="Runtime hamburger" />`;
const alertIcons = ["info", "success", "warning", "error"];
const alertIconsCode = alertIcons.map((name) => `<Icon name="${name}" />`).join("\\n");

const props = [
  { name: "name", type: "string", default: '"spark"', description: "Registry icon name." },
  {
    name: "label",
    type: "string",
    description: "Accessible label; omitting hides icon from a11y tree."
  },
  {
    name: "size",
    type: `"sm" | "md" | "lg"`,
    default: '"md"',
    description: "Pre-set pixel sizes (16/24/32)."
  },
  { name: "svgPath", type: "string", description: "Inner SVG path(s) to render." },
  { name: "svg", type: "string", description: "Full inner SVG markup (without outer <svg>)." },
  { name: "viewBox", type: "string", description: "Custom viewBox when using svg/svgPath." },
  { name: "strokeWidth", type: "string | number", description: "Stroke width override." },
  { name: "strokeLinecap", type: "string", description: "Stroke linecap override." },
  { name: "strokeLinejoin", type: "string", description: "Stroke linejoin override." },
  { name: "class", type: "string", description: "Additional className." },
  {
    deprecated: true,
    name: "color",
    type: "string",
    description: "Deprecated â€” use CSS color or style vars (--icon-color)."
  }
];

const styleVars = [
  { name: "--icon-size", description: "Icon width/height.", default: "16/24/32px (by size prop)" },
  {
    name: "--icon-color",
    description: "Icon color (stroke/fill via currentColor).",
    default: "inherit"
  }
];
---

<DocLayout
  title="Icon"
  description="Inline SVG icons with consistent sizing and color."
  items={components}
>
  <PropsTable props={props} />

  <PropsTable title="Style variables" props={styleVars} />

  <Preview title="Default" code={defaultCode}>
    <div class="row">
      {iconNames.map((name) => <IconComponent name={name} />)}
    </div>
  </Preview>

  <Preview title="Registry icons" code={registryCode}>
    <div class="row">
      {registryNames.map((name) => <IconComponent name={name} />)}
    </div>
  </Preview>

  <Preview title="Alert icons" code={alertIconsCode}>
    <div class="row">
      {alertIcons.map((name) => <IconComponent name={name} label={`${name} icon`} />)}
    </div>
  </Preview>

  <Preview title="Runtime SVG" code={runtimeCode}>
    <div class="row">
      <IconComponent svgPath={runtimeSvg} viewBox="0 0 24 24" label="Runtime hamburger" />
      <IconComponent
        svgPath={'<path d="M5 12h14" /><path d="M13 6l6 6-6 6" />'}
        viewBox="0 0 24 24"
        label="Runtime arrow"
      />
    </div>
  </Preview>

  <section class="notes">
    <h3>Usage notes</h3>
    <p>The `Icon` component supports two modes:</p>
    <ul>
      <li>
        <strong>Registry:</strong> pass `name="icon-name"` to use a predefined icon from the registry.
      </li>
      <li>
        <strong>Runtime SVG:</strong> pass `svgPath="<path ...></path>"` (and optional `viewBox`,
        `strokeWidth`, `strokeLinecap`, `strokeLinejoin`) to render ad-hoc SVG markup without
        rebuilding the library.
      </li>
    </ul>
    <p>
      For safety and consistency the component sanitizes the inner SVG markup by removing any inline
      `fill`, `stroke` and `style` attributes. The outer &lt;svg> uses `fill="currentColor"` and
      `stroke="currentColor"`, so icons inherit color from CSS. To override the color, set parent
      `color` or `--icon-color`.
    </p>
    <p>
      Accessibility: provide a `label` to expose an accessible name. If no label is supplied the
      icon is considered decorative and will be `aria-hidden`.
    </p>
    <pre><code>// registry
&lt;Icon name="external" label="Open external link" /&gt;

// runtime
&lt;Icon svgPath='<path d="M3 6h18" />' viewBox='0 0 24 24' label="Menu" /&gt;</code></pre>
  </section>

  <Preview title="Sizes" code={sizesCode}>
    <div class="row">
      <IconComponent name="spark" size="sm" />
      <IconComponent name="spark" size="md" />
      <IconComponent name="spark" size="lg" />
    </div>
  </Preview>
</DocLayout>

<style>
  .row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    align-items: center;
  }
</style>
