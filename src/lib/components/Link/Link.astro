---
import Icon from "../Icon/Icon.astro";
import Button from "../Button/Button.astro";
/*
Props:
- label?: string
- href?: string
- target?: string
- rel?: string
- variant?: "solid" | "outline" | "ghost" (default "ghost")
- size?: "xs" | "sm" | "md" | "lg" (default "md")
- disabled?: boolean
Notes:
- rel defaults to "noreferrer" when target is "_blank".
*/
const {
  label = "Read more",
  href,
  target,
  rel,
  variant = "ghost",
  size = "md",
  disabled = false
} = Astro.props;
let resolvedLabel = label;
const resolvedHref = href;
const resolvedTarget = target;
const resolvedRel = rel ?? (resolvedTarget === "_blank" ? "noreferrer" : undefined);
const className = `button button--${variant} button--${size}`;
const isExternal = resolvedHref && /^(https?:)?\/\//.test(resolvedHref);
---

<Button
  class={className}
  href={resolvedHref}
  target={resolvedTarget}
  rel={resolvedRel}
  disabled={disabled}
  variant={variant}
  size={size}
>
  <span>{resolvedLabel}</span>
  {
    isExternal && (
      <Icon
        content={{ name: "external" }}
        size={size === "sm" ? "sm" : "md"}
        label={`${resolvedLabel} (opens in new tab)`}
      />
    )
  }
</Button>
